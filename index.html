<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Itsbad — Showcase</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000;
            color: #fafafa;
            -webkit-font-smoothing: antialiased;
        }

        /* Natural Fade-in */
        .view-transition {
            animation: softAppear 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes softAppear {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Subtle Card Hover */
        .product-card {
            transition: transform 0.4s ease, background 0.4s ease;
        }

        .product-card:hover {
            background: #0a0a0a;
            transform: translateY(-4px);
        }

        /* Minimal Scrollbar */
        ::-webkit-scrollbar { width: 3px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #333; }

        input:focus, textarea:focus {
            border-color: #fff !important;
        }
        
        /* Skeleton loading style */
        .img-placeholder {
            background: linear-gradient(90deg, #0a0a0a 25%, #111 50%, #0a0a0a 75%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body class="selection:bg-white selection:text-black">

    <nav class="fixed top-0 w-full z-50 bg-black/80 backdrop-blur-md border-b border-white/[0.05]">
        <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-4 cursor-pointer" onclick="switchView('landing')">
                <span class="font-bold tracking-tighter text-lg uppercase">Itsbad.</span>
            </div>
            <div id="admin-indicator" class="hidden flex items-center gap-2">
                <span class="w-1.5 h-1.5 bg-green-500 rounded-full"></span>
                <span class="text-[10px] font-medium text-neutral-400 uppercase tracking-widest">Active Session</span>
                <button onclick="logoutAdmin()" class="ml-2 text-neutral-600 hover:text-white"><i data-lucide="log-out" class="w-4 h-4"></i></button>
            </div>
        </div>
    </nav>

    <main id="landing-view" class="view-transition pt-40 pb-20 px-6 max-w-6xl mx-auto hidden">
        <header class="mb-20">
            <h1 class="text-5xl md:text-7xl font-semibold tracking-tight leading-tight mb-6 text-white">
                Kurasi produk <br> yang kami sukai.
            </h1>
            <p class="text-neutral-500 text-lg max-w-xl font-light">
                Kumpulan referensi produk terbaik dari marketplace untuk menunjang produktivitas dan gaya hidup digital Anda.
            </p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <button onclick="switchView('showcase', 'shopee')" class="group relative flex flex-col justify-between p-8 h-64 border border-white/10 rounded-2xl hover:bg-neutral-900 transition-all text-left">
                <i data-lucide="shopping-bag" class="w-6 h-6 text-neutral-400 group-hover:text-white transition-colors"></i>
                <div>
                    <h3 class="text-xl font-medium mb-1">Shopee</h3>
                    <p class="text-neutral-500 text-sm">Fashion & Essentials</p>
                </div>
            </button>

            <button onclick="switchView('showcase', 'tiktok')" class="group relative flex flex-col justify-between p-8 h-64 border border-white/10 rounded-2xl hover:bg-neutral-900 transition-all text-left">
                <i data-lucide="video" class="w-6 h-6 text-neutral-400 group-hover:text-white transition-colors"></i>
                <div>
                    <h3 class="text-xl font-medium mb-1">TikTok</h3>
                    <p class="text-neutral-500 text-sm">Viral Collections</p>
                </div>
            </button>

            <button onclick="switchView('showcase', 'tokopedia')" class="group relative flex flex-col justify-between p-8 h-64 border border-white/10 rounded-2xl hover:bg-neutral-900 transition-all text-left">
                <i data-lucide="box" class="w-6 h-6 text-neutral-400 group-hover:text-white transition-colors"></i>
                <div>
                    <h3 class="text-xl font-medium mb-1">Tokopedia</h3>
                    <p class="text-neutral-500 text-sm">Tech & Lifestyle</p>
                </div>
            </button>
        </div>

        <button onclick="toggleLoginModal(true)" class="mt-32 opacity-0 hover:opacity-100 transition-opacity">
            <i data-lucide="key" class="w-4 h-4"></i>
        </button>
    </main>

    <main id="showcase-view" class="view-transition pt-32 pb-20 px-6 max-w-7xl mx-auto hidden">
        <div class="flex flex-col md:flex-row justify-between items-baseline mb-12 gap-4">
            <div>
                <button onclick="switchView('landing')" class="text-neutral-500 hover:text-white flex items-center gap-2 text-xs mb-4 transition-colors">
                    <i data-lucide="arrow-left" class="w-3 h-3"></i> Home
                </button>
                <h2 id="platform-title" class="text-4xl font-semibold capitalize">Platform</h2>
            </div>
            <p class="text-neutral-500 text-sm font-light italic" id="item-count">Menampilkan 0 produk</p>
        </div>

        <div id="admin-panel" class="hidden border border-white/10 rounded-2xl p-8 mb-16 bg-neutral-950">
            <h4 class="text-sm font-semibold uppercase tracking-widest mb-6 flex items-center gap-2">
                <i data-lucide="plus" class="w-4 h-4"></i> Tambah Data
            </h4>
            <form id="product-form" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <input type="hidden" id="edit-id">
                <input id="in-title" required placeholder="Judul produk" class="bg-black border border-white/10 rounded-lg px-4 py-3 text-sm outline-none">
                <input id="in-link" required type="url" placeholder="Link (URL)" class="bg-black border border-white/10 rounded-lg px-4 py-3 text-sm outline-none">
                <input id="in-order" type="number" required placeholder="Urutan (1, 2...)" class="bg-black border border-white/10 rounded-lg px-4 py-3 text-sm outline-none">
                <div class="flex gap-2">
                    <input id="in-image" placeholder="Image URL" class="flex-1 bg-black border border-white/10 rounded-lg px-4 py-3 text-[11px] outline-none">
                    <label class="bg-white/10 p-3 rounded-lg cursor-pointer hover:bg-white/20">
                        <i data-lucide="upload" class="w-4 h-4"></i>
                        <input type="file" id="file-input" class="hidden" accept="image/*">
                    </label>
                </div>
                <div class="md:col-span-3">
                    <textarea id="in-desc" placeholder="Deskripsi singkat..." class="w-full bg-black border border-white/10 rounded-lg px-4 py-3 text-sm h-20 outline-none resize-none"></textarea>
                </div>
                <button type="submit" id="btn-submit" class="bg-white text-black font-semibold rounded-lg hover:bg-neutral-200 transition-colors text-sm py-3">Simpan Produk</button>
            </form>
        </div>

        <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>

        <div id="empty-msg" class="hidden py-40 text-center text-neutral-700">
            <p class="font-light">Belum ada produk untuk ditampilkan.</p>
        </div>
    </main>

    <div id="login-modal" class="fixed inset-0 z-[100] hidden items-center justify-center bg-black/90 backdrop-blur-sm p-6">
        <div class="w-full max-w-xs text-center">
            <h3 class="text-xl font-medium mb-8 uppercase tracking-widest">Master Access</h3>
            <form id="login-form">
                <input id="login-pass" type="password" placeholder="Key" class="w-full bg-transparent border-b border-white/20 pb-2 text-center text-2xl outline-none focus:border-white transition-colors mb-8">
                <div class="flex flex-col gap-4">
                    <button type="submit" class="bg-white text-black py-3 rounded-full font-bold text-xs uppercase tracking-widest">Enter</button>
                    <button type="button" onclick="toggleLoginModal(false)" class="text-neutral-500 text-xs uppercase tracking-widest hover:text-white">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBb3HZbY7Tk6gWQagRSEOhi0dZVZ5mWFDA",
            authDomain: "showcaseitsbad.firebaseapp.com",
            projectId: "showcaseitsbad",
            storageBucket: "showcaseitsbad.firebasestorage.app",
            messagingSenderId: "964069299303",
            appId: "1:964069299303:web:dfcc88ced5a701ce2eb0c2"
        };

        let db, auth, isAdmin = false, allProducts = [], currentPlatform = null, isEditing = false;

        async function init() {
            try {
                const app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                await signInAnonymously(auth);
                document.getElementById('landing-view').classList.remove('hidden');
                setupRealtimeData();
                lucide.createIcons();
            } catch (err) { console.error(err); }
        }

        function setupRealtimeData() {
            onSnapshot(collection(db, 'products'), (snapshot) => {
                allProducts = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));
                if (currentPlatform) renderGrid();
            });
        }

        window.switchView = (view, platform = null) => {
            document.getElementById('landing-view').classList.add('hidden');
            document.getElementById('showcase-view').classList.add('hidden');
            
            if (view === 'landing') {
                document.getElementById('landing-view').classList.remove('hidden');
                currentPlatform = null;
            } else {
                document.getElementById('showcase-view').classList.remove('hidden');
                currentPlatform = platform;
                document.getElementById('platform-title').innerText = platform;
                renderGrid();
            }
            lucide.createIcons();
            window.scrollTo({ top: 0 });
        };

        window.toggleLoginModal = (show) => {
            const modal = document.getElementById('login-modal');
            modal.classList.toggle('hidden', !show);
            if(show) modal.classList.add('flex'); else modal.classList.remove('flex');
        };

        document.getElementById('login-form').onsubmit = (e) => {
            e.preventDefault();
            if (document.getElementById('login-pass').value === '110603') {
                isAdmin = true;
                toggleLoginModal(false);
                document.getElementById('admin-panel').classList.remove('hidden');
                document.getElementById('admin-indicator').classList.remove('hidden');
                renderGrid();
            } else { alert("Key incorrect."); }
        };

        window.logoutAdmin = () => {
            isAdmin = false;
            document.getElementById('admin-panel').classList.add('hidden');
            document.getElementById('admin-indicator').classList.add('hidden');
            renderGrid();
        };

        document.getElementById('product-form').onsubmit = async (e) => {
            e.preventDefault();
            const payload = {
                title: document.getElementById('in-title').value,
                description: document.getElementById('in-desc').value,
                link: document.getElementById('in-link').value,
                image: document.getElementById('in-image').value,
                sortOrder: parseInt(document.getElementById('in-order').value) || 0,
                platform: currentPlatform,
                updatedAt: new Date().toISOString()
            };
            try {
                if (isEditing) {
                    await updateDoc(doc(db, 'products', document.getElementById('edit-id').value), payload);
                } else {
                    await addDoc(collection(db, 'products'), payload);
                }
                resetForm();
            } catch (err) { alert(err.message); }
        };

        window.startEdit = (id) => {
            const p = allProducts.find(x => x.id === id);
            isEditing = true;
            document.getElementById('edit-id').value = p.id;
            document.getElementById('in-title').value = p.title;
            document.getElementById('in-desc').value = p.description;
            document.getElementById('in-link').value = p.link;
            document.getElementById('in-image').value = p.image;
            document.getElementById('in-order').value = p.sortOrder;
            document.getElementById('btn-submit').innerText = "Update";
            window.scrollTo({ top: 100, behavior: 'smooth' });
        };

        window.deleteProd = async (id) => {
            if (confirm("Hapus item?")) await deleteDoc(doc(db, 'products', id));
        };

        window.resetForm = () => {
            isEditing = false;
            document.getElementById('product-form').reset();
            document.getElementById('btn-submit').innerText = "Simpan Produk";
            lucide.createIcons();
        };

        document.getElementById('file-input').onchange = (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = () => document.getElementById('in-image').value = reader.result;
                reader.readAsDataURL(file);
            }
        };

        function renderGrid() {
            const grid = document.getElementById('product-grid');
            const empty = document.getElementById('empty-msg');
            const filtered = allProducts
                .filter(p => p.platform === currentPlatform)
                .sort((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0));

            document.getElementById('item-count').innerText = `Menampilkan ${filtered.length} produk`;

            if (filtered.length === 0) {
                grid.innerHTML = '';
                empty.classList.remove('hidden');
                return;
            }

            empty.classList.add('hidden');
            grid.innerHTML = filtered.map((p, i) => `
                <div class="product-card group bg-neutral-950 border border-white/[0.05] rounded-xl p-4">
                    <div class="aspect-square rounded-lg overflow-hidden mb-5 bg-neutral-900">
                        <img src="${p.image || ''}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" loading="lazy" onerror="this.classList.add('img-placeholder'); this.src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'">
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between items-start">
                            <h4 class="text-sm font-medium text-white">${p.title}</h4>
                            ${isAdmin ? `
                                <div class="flex gap-2">
                                    <button onclick="startEdit('${p.id}')" class="text-neutral-500 hover:text-white"><i data-lucide="edit-2" class="w-3.5 h-3.5"></i></button>
                                    <button onclick="deleteProd('${p.id}')" class="text-neutral-500 hover:text-red-500"><i data-lucide="x" class="w-3.5 h-3.5"></i></button>
                                </div>
                            ` : ''}
                        </div>
                        <p class="text-xs text-neutral-500 font-light leading-relaxed line-clamp-2">${p.description || 'Pilihan terbaik untuk kategori ini.'}</p>
                        <div class="pt-4 flex items-center justify-between">
                            <span class="text-[10px] text-neutral-600 font-bold uppercase tracking-widest">${p.sortOrder || i + 1} • Store</span>
                            <a href="${p.link}" target="_blank" class="text-xs font-semibold hover:underline flex items-center gap-1">
                                Lihat Produk <i data-lucide="chevron-right" class="w-3 h-3"></i>
                            </a>
                        </div>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        init();
    </script>
</body>
</html>
